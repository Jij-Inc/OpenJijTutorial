{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a href=\"https://colab.research.google.com/github/OpenJij/OpenJijTutorial/blob/master/ja/A3-LargeScaleMC.ipynb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# A3 - 古典イジング模型\n",
    "\n",
    "[![Open in Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/OpenJij/OpenJijTutorial/blob/master/ja/A3-LargeScaleMC.ipynb)\n",
    "\n",
    "この章ではOpenJijのcore interface (core python interface)の使い方を説明し、簡単な計算のデモンストレーションを行います。\n",
    "\n",
    "core interfaceは前回までのチュートリアルよりも下部のレイヤーのAPIとなるため、対象読者としては前回までのOpenJijチュートリアルを一通り終えて、イジングモデルやモンテカルロ法などの用語を知っている方を想定しており、\n",
    "\n",
    "* 最適化問題だけでなくサンプリングや研究用途などより専門的な用途にOpenJijを用いたい\n",
    "* アニーリングスケジュールの設定や使用するアルゴリズム等を直接触りたい\n",
    "\n",
    "といった目的に使用できます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "前回ではスピン数$N=5$の小さいシステムでのデモンストレーションを行いましたが、この章ではさらに大規模な計算を通してOpenJij core interfaceの機能、使い方をより詳しく見ていきます。\n",
    "\n",
    "題材としてランダムイジング模型を取り上げます。この模型は、ハミルトニアンが\n",
    "\\begin{align}\n",
    "H &= \\sum_{i<j}J_{ij}\\sigma_i \\sigma_j + \\sum_{i=1}^{N}h_i \\sigma_i \\\\\n",
    "\\sigma_i &= \\pm 1 (i=1 \\cdots N)\n",
    "\\end{align}\n",
    "で与えられて、$J_{ij}, h_{i}$が$(i,j)$に対して様々な値を持つ模型です。  \n",
    "様々な種類の最適化問題がこのような模型の一番低いエネルギーを求める問題となりますが、エネルギーの最も低い状態を実現する$\\sigma_i$を計算するには一般に非常に難しいです。\n",
    "\n",
    "## 問題の定義 - Graph -\n",
    "\n",
    "問題を定義してみましょう。`graph`の中の**Dense**モジュールが必要となります。\n",
    "> `graph`中には基本的に**Dense**モジュールと**Sparse**モジュールがあり、今回の例のように全ての$J_{ij}$で値が定義されている場合には**Dense**モジュールが適しています。多くの$J_{ij}$の要素が0の場合には**Sparse**が適しています。使い方はどちらもほぼ変わりません。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import cxxjij.graph as G\n",
    "#問題サイズを100とします。\n",
    "N = 100\n",
    "\n",
    "graph = G.Dense(N)\n",
    "#sparseの場合\n",
    "#graph = G.Sparse(N)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$J_{ij}, h_i$を設定します。今回は平均0、標準偏差1のGauss分布から生成される値を設定します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Defaulting to user installation because normal site-packages is not writeable\n",
      "Requirement already satisfied: numpy in /usr/lib/python3.8/site-packages (1.18.1)\n"
     ]
    }
   ],
   "source": [
    "!pip install numpy #乱数生成にnumpyを使います。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "mu, sigma = 0, 1\n",
    "\n",
    "for i in range(N):\n",
    "    for j in range(N):\n",
    "        #Jijの値が大きくなりすぎてしまうので、全体の係数を1/Nしています。\n",
    "        graph[i,j] = 0 if i == j else np.random.normal()/N\n",
    "\n",
    "for i in range(N):\n",
    "    graph[i] = np.random.normal()/N"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "ここで、縦磁場に関しては、`graph[i]`でも、`graph[i,i]`でもどちらでもアクセスできます。\n",
    "\n",
    "また、イジングモデルの定義上、$J_{ij}$と$J_{ji}$は自動で同じ値となります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.5\n",
      "0.5\n",
      "-0.6\n",
      "-0.6\n"
     ]
    }
   ],
   "source": [
    "graph[20] = 0.5\n",
    "print(graph[20,20])\n",
    "print(graph[20])\n",
    "graph[12,34] = -0.6\n",
    "print(graph[12,34])\n",
    "print(graph[34,12])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Dense** (および**Sprase**)は以下のメソッドを持っています。\n",
    "\n",
    "- .gen_spin(seed)  \n",
    "    乱数生成のためのseedを与えると、システムサイズ (ここでは$N=100$)分のスピン列を出力します。\n",
    "    seedがない場合にはランダムにseedが決定されます。\n",
    "- .size()  \n",
    "    問題のサイズ($N$)を表示します。\n",
    "- .adj_nodes(i)  \n",
    "    インデックス$i$に隣接するノード一覧を表示します。\n",
    "- .calc_energy(spin)  \n",
    "    スピン列spinを与えられた際に、エネルギー\n",
    "    \\begin{align}  \n",
    "    H &= \\sum_{i<j}J_{ij}\\sigma_i \\sigma_j + \\sum_{i=1}^{N}h_i \\sigma_i\n",
    "    \\end{align}\n",
    "    を計算します。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## システムの設定 - System -\n",
    "\n",
    "続いて計算を行うためのシステムを定義します。ここで古典イジング模型か横磁場イジング模型か、また別の模型にするか等を選べます。\n",
    "\n",
    "まずは古典イジング模型のシステムを作成してみます。`system.make_classical_ising`で作成できます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "import cxxjij.system as S\n",
    "\n",
    "mysystem = S.make_classical_ising(graph.gen_spin(), graph)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "ここで、引数の1つめにはランダムに生成したスピン、2つめはGraphそのものを代入しています。  \n",
    "これにより初期スピン配位が`graph.gen_spin()`となる古典イジング模型のシステムが作成できます。\n",
    "\n",
    "\n",
    "> `system.make_classical_ising`は内部でGraphとspinをそのまま保持しています。実装は[ここ](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/system/classical_ising.hpp#L37)にあり、63行目でメンバ変数\n",
    ">```cpp\n",
    ">graph::Spins spin;\n",
    ">const GraphType interaction;\n",
    ">```\n",
    ">が定義されています。  \n",
    ">古典イジング模型に関しては、行列演算ライブラリEigenを用いて最適化されたシステムである`system.make_classical_ising_Eigen`も用意しています。(実装は[ここ](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/system/classical_ising.hpp#L78))\n",
    ">計算速度はこちらのほうが速いので**実際の用途では`system.make_classical_ising_Eigen`を使うことをおすすめします。**\n",
    "\n",
    "システムに直接アクセスして、値を読むこともできます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1, -1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, 1, -1, 1, -1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, 1, 1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1]\n"
     ]
    }
   ],
   "source": [
    "print(mysystem.spin)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "古典イジング模型以外にも様々なシステムが用意されており、用途別に使うことが出来ます。また、Systemによって初期化の方法は多少異なります。  \n",
    "後ほど少しずつ紹介していきます。\n",
    "\n",
    "## アルゴリズムの実行 -Updater, Algorithm-\n",
    "\n",
    "Systemを定義した後はUpdaterを選択してAlgorithmを実行していきます。  \n",
    "Systemに大して使用できるUpdaterは決められており、古典イジング模型に対するUpdaterは主に\n",
    "\n",
    "- [SingleSpinFlip](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/updater/single_spin_flip.hpp#L40) (メトロポリス・ヘイスティング法によるスピン1つずつのアップデート)\n",
    "- [SwendsenWang](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/updater/swendsen_wang.hpp#L45) (SwendsenWang法によるクラスターアップデート)\n",
    "\n",
    "が用意されています。  \n",
    "Algorithmを実行するにはまず**スケジュールリスト**が必要となるため、まずスケジュールリストを作成するところから始めます。\n",
    "\n",
    "### スケジュールリスト\n",
    "\n",
    "スケジュールリストは`(パラメータ, モンテカルロステップ数)`のリストで与えられ、パラメータにいれる値はSystemによって異なります。例えば古典イジング模型ならばパラメータとして温度の逆数である逆温度$\\beta$を設定します。\n",
    "例えばスケジュールリストとして"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "schedule_list = [(0.01, 10),(10, 80),(0.1, 30)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "と設定された場合、逆温度$\\beta=0.01$で10モンテカルロステップ、$\\beta=10$で80ステップ、$\\beta=0.1$で30ステップの計120モンテカルロステップを実行することを意味します。\n",
    "\n",
    "アニーリングを実行するにあたっては、逆温度は等比級数で増加させていくことが多いため、`utility`にある`make_classical_schedule_list`を使うと便利です。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[((beta: 0.100000) mcs: 20), ((beta: 0.199474) mcs: 20), ((beta: 0.397897) mcs: 20), ((beta: 0.793701) mcs: 20), ((beta: 1.583223) mcs: 20), ((beta: 3.158114) mcs: 20), ((beta: 6.299605) mcs: 20), ((beta: 12.566053) mcs: 20), ((beta: 25.065966) mcs: 20), ((beta: 50.000000) mcs: 20)]\n"
     ]
    }
   ],
   "source": [
    "import cxxjij.utility as U\n",
    "schedule_list = U.make_classical_schedule_list(0.1, 50, 20, 10)\n",
    "print(schedule_list)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "上の例では$\\beta=0.1$から$\\beta=50$まで、各温度で20モンテカルロステップ計算しながら10段階で温度を変えていくため、計200モンテカルロステップの計算となります。\n",
    "\n",
    "### Algorithm\n",
    "\n",
    "続いて、Algorithmを実行していきます。`Algorithm_[Updater]_run`のように書くことで、指定したUpdaterで計算を行うことができます。次例ではSingleSpinFlipを用います。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "import cxxjij.algorithm as A\n",
    "A.Algorithm_SingleSpinFlip_run(mysystem, schedule_list)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "一瞬で処理が終わりましたが、この間に計200モンテカルロステップの計算が終わっています。\n",
    "> `A.Algorithm_SingleSpinFlip_run(mysystem, seed, schedule_list)`とすることで、seedを固定したまま計算を行うことができます。結果に再現性をもたせたい際に使うことができます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "callbackを使用することでAlgorithmの実行中に1モンテカルロステップごとのシステムを取得することができます。古典イジング模型の場合は、システムとパラメータ (逆温度)を引数を持つ関数を作成すれば良いです。\n",
    "\n",
    "ためしにシステムのエネルギーの値を記録するcallbackを作ってみましょう"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "energies = []\n",
    "\n",
    "def callback_log_energy(system, beta):\n",
    "    #graphは以前にGraphモジュールにて定義したオブジェクトです\n",
    "    energies.append(graph.calc_energy(system.spin))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "このcallbackを用いて同じAlgorithmを実行します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "#スケジュールをもっと長く取ります (計20000モンテカルロステップ)\n",
    "schedule_list = U.make_classical_schedule_list(0.1, 50, 200, 100)\n",
    "A.Algorithm_SingleSpinFlip_run(mysystem, schedule_list, callback_log_energy)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "記録したシステムのエネルギーを横軸をモンテカルロステップ、縦軸をエネルギーでプロットすると次のようになります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Defaulting to user installation because normal site-packages is not writeable\n",
      "Requirement already satisfied: matplotlib in /usr/lib/python3.8/site-packages (3.2.0)\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/lib/python3.8/site-packages (from matplotlib) (0.10.0)\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/lib/python3.8/site-packages (from matplotlib) (1.1.0)\n",
      "Requirement already satisfied: numpy>=1.11 in /usr/lib/python3.8/site-packages (from matplotlib) (1.18.1)\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/lib/python3.8/site-packages (from matplotlib) (2.4.6)\n",
      "Requirement already satisfied: python-dateutil>=2.1 in /usr/lib/python3.8/site-packages (from matplotlib) (2.8.1)\n",
      "Requirement already satisfied: six in /usr/lib/python3.8/site-packages (from cycler>=0.10->matplotlib) (1.14.0)\n",
      "Requirement already satisfied: setuptools in /usr/lib/python3.8/site-packages (from kiwisolver>=1.0.1->matplotlib) (46.0.0)\n"
     ]
    }
   ],
   "source": [
    "!pip install matplotlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "plt.plot(range(len(energies)), energies)\n",
    "plt.xlabel('Monte Carlo step')\n",
    "plt.ylabel('energy')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "このように、アニーリングが進むに連れ徐々にエネルギーが低くなっているのが分かります。Algorithmの動作中にシステムの様子を知りたい時に有用です。\n",
    "\n",
    "## 結果の取得 -Result-\n",
    "\n",
    "`result.get_solution`で計算結果であるスピン列を取得できます。古典イジング模型の場合は直接`mysystem.spin`を参照すればスピン列を取得できますが、`result.get_solution`はそれ以外のシステムについてもスピン列を取得できます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[1, -1, 1, 1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, 1, 1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1, 1, 1, 1, -1, -1, -1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, -1, -1, 1, 1, 1, -1, 1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, -1]\n"
     ]
    }
   ],
   "source": [
    "import cxxjij.result as R\n",
    "print(R.get_solution(mysystem))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "このスピン列がアニーリングによって得られた答えなので、ハミルトニアンの基底状態 (に近い状態)であることが期待されます。\n",
    "\n",
    "## `system.make_classical_ising_Eigen` \n",
    "\n",
    "注釈で述べたように、古典イジング模型には線形代数ライブラリである[Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page)で実装された`system.make_classical_ising_Eigen`があります。`system.make_classical_ising`との計算速度をシステムサイズを変えて比較してみましょう。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import time\n",
    "\n",
    "N_list = [10, 20, 30, 50, 70, 80, 100, 150, 200, 300, 400, 500, 1000]\n",
    "\n",
    "#計算時間\n",
    "calctime = []\n",
    "#計算時間 (Eigen実装)\n",
    "calctime_eigen = []\n",
    "\n",
    "for N in N_list:\n",
    "    #Graphの初期化\n",
    "    graph = G.Dense(N)\n",
    "    for i in range(N):\n",
    "        for j in range(N):\n",
    "            #Jijの値が大きくなりすぎてしまうので、全体の係数を1/Nしています。\n",
    "            graph[i,j] = 0 if i == j else np.random.normal()/N\n",
    "\n",
    "    for i in range(N):\n",
    "        graph[i] = np.random.normal()/N\n",
    "    \n",
    "    #Systemの初期化\n",
    "    mysystem = S.make_classical_ising(graph.gen_spin(), graph)\n",
    "    mysystem_eigen = S.make_classical_ising_Eigen(graph.gen_spin(), graph)\n",
    "    \n",
    "    #スケジュールリスト (2000モンテカルロステップ)\n",
    "    schedule_list = U.make_classical_schedule_list(0.1, 50, 20, 100)\n",
    "    \n",
    "    t1 = time.time()\n",
    "    #アニーリング (Eigenなし)\n",
    "    A.Algorithm_SingleSpinFlip_run(mysystem, schedule_list)\n",
    "    t2 = time.time()\n",
    "    calctime.append(t2-t1)\n",
    "    \n",
    "    t1 = time.time()\n",
    "    #アニーリング (Eigenあり)\n",
    "    A.Algorithm_SingleSpinFlip_run(mysystem_eigen, schedule_list)\n",
    "    t2 = time.time()\n",
    "    calctime_eigen.append(t2-t1)\n",
    "\n",
    "#結果を両対数プロット\n",
    "plt.plot(N_list, calctime, 'ro-', label='Without Eigen')\n",
    "plt.plot(N_list, calctime_eigen, 'bx-', label='With Eigen')\n",
    "plt.xlabel('System size')\n",
    "plt.ylabel('Elapsed time[s]')\n",
    "plt.xscale('log')\n",
    "plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "全体的にEigen実装のほうが計算が早く、大きいシステムサイズではほぼ10倍ほどのスピード差があります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## C++ core interface\n",
    "\n",
    "C++ core interfaceでも上記とほぼ同じことが可能ですが、多少の違いがあり、\n",
    "\n",
    "- seed値を入れる引数には、乱数生成器 (C++11 random)を代入する必要があります。今までのコードはC++で次のようになります。\n",
    "- Graphクラスで、$J_{ij}, h_i$へのアクセス方法が多少異なります。\n",
    "\n",
    "今までの内容をC++ core interfaceで記述すると次のようになります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```cpp\n",
    "#include <graph/all.hpp>\n",
    "#include <system/all.hpp>\n",
    "#include <updater/all.hpp>\n",
    "#include <algorithm/all.hpp>\n",
    "#include <result/all.hpp>\n",
    "#include <utility/schedule_list.hpp>\n",
    "#include <utility/random.hpp>\n",
    "#include <random>\n",
    "\n",
    "#include <iostream>\n",
    "\n",
    "using namespace openjij;\n",
    "\n",
    "int main(void){\n",
    "\n",
    "    //generate dense graph with size N=100\n",
    "    constexpr std::size_t N = 100;\n",
    "    auto dense = graph::Dense<double>(N);\n",
    "\n",
    "    //generate random engine\n",
    "    auto rand_engine = std::mt19937(0x1234);\n",
    "    //of course you can specify another random generator that is compatible with C++ random generator, say utility::Xorshift,\n",
    "    //auto rand_engine = utility::Xorshift(0x1234);\n",
    "    \n",
    "    //Gaussian distribution\n",
    "    auto gauss = std::normal_distribution<>{0, 1};\n",
    "\n",
    "    //set interactions\n",
    "    for(std::size_t i=0; i<N; i++){\n",
    "        for(std::size_t j=0; j<N; j++){\n",
    "            dense.J(i, j) = (i == j) ? 0 : gauss(rand_engine)/N;\n",
    "        }\n",
    "    }\n",
    "\n",
    "    //set local fields\n",
    "    for(std::size_t i=0; i<N; i++){\n",
    "        dense.h(i) = gauss(rand_engine);\n",
    "    }\n",
    "\n",
    "    //create classical Ising system\n",
    "    auto system = system::make_classical_ising(dense.gen_spin(rand_engine), dense);\n",
    "    //if you use classical Ising system with Eigen implementation, use\n",
    "    //auto system = system::make_classical_ising<system::USE_EIGEN>(dense.gen_spin(rand_engine), dense);\n",
    "\n",
    "    //generate schedule list\n",
    "    //from beta=0.1 to beta=50, 20 Monte Carlo step for each tempearature, 10 samples\n",
    "    auto schedule_list = utility::make_classical_schedule_list(0.1, 50, 20, 10);\n",
    "\n",
    "    //or in the case of classical system, you can specify arbitrary schedules by using a std::vector of utility::Schedule<system::classical_system>\n",
    "    //std::vector<utility::Schedule<system::classical_system>> schedule_list;\n",
    "    //utility::Schedule<system::classical_system> schedule;\n",
    "    //schedule.updater_parameter = {0.01};\n",
    "    //schedule.one_mc_step = 10; //number of Monte Carlo step per temperature\n",
    "    //schedule_list.push_back(schedule);\n",
    "    //\n",
    "    //schedule.updater_parameter = {10};\n",
    "    //schedule.one_mc_step = 80; //number of Monte Carlo step per temperature\n",
    "    //schedule_list.push_back(schedule);\n",
    "    //\n",
    "    //schedule.updater_parameter = {0.1};\n",
    "    //schedule.one_mc_step = 30; //number of Monte Carlo step per temperature\n",
    "    //schedule_list.push_back(schedule); //schedule_list -> [(0.01, 10), (10, 80), (0.1, 30)]\n",
    "\n",
    "\n",
    "    //do annealing (updater: SingleSpinFlip)\n",
    "    algorithm::Algorithm<updater::SingleSpinFlip>::run(system, rand_engine, schedule_list);\n",
    "\n",
    "    //show spins\n",
    "    std::cout << \"The result spins are [\";\n",
    "    for(auto&& elem : result::get_solution(system)){\n",
    "        std::cout << elem << \" \";\n",
    "    }\n",
    "\n",
    "    std::cout << \"]\" << std::endl;\n",
    "}\n",
    "\n",
    "```"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
