{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<a href=\"https://colab.research.google.com/github/OpenJij/OpenJijTutorial/blob/master/ja/A3-LargeScaleMC.ipynb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# A3 - 古典イジング模型\n",
    "\n",
    "[![Open in Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/OpenJij/OpenJijTutorial/blob/master/ja/A3-LargeScaleMC.ipynb)\n",
    "\n",
    "この章ではOpenJijのcore interface (core python interface)の使い方を説明し、簡単な計算のデモンストレーションを行います。\n",
    "\n",
    "core interfaceは前回までのチュートリアルよりも下部のレイヤーのAPIとなるため、対象読者としては前回までのOpenJijチュートリアルを一通り終えて、イジングモデルやモンテカルロ法などの用語を知っている方を想定しており、\n",
    "\n",
    "* 最適化問題だけでなくサンプリングや研究用途などより専門的な用途にOpenJijを用いたい\n",
    "* アニーリングスケジュールの設定や使用するアルゴリズム等を直接触りたい\n",
    "\n",
    "といった目的に使用できます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "前回ではスピン数$N=5$の小さいシステムでのデモンストレーションを行いましたが、この章ではさらに大規模な計算を通してOpenJij core interfaceの機能、使い方をより詳しく見ていきます。\n",
    "\n",
    "題材としてランダムイジング模型を取り上げます。この模型は、ハミルトニアンが\n",
    "\\begin{align}\n",
    "H &= \\sum_{i<j}J_{ij}\\sigma_i \\sigma_j + \\sum_{i=1}^{N}h_i \\sigma_i \\\\\n",
    "\\sigma_i &= \\pm 1 (i=1 \\cdots N)\n",
    "\\end{align}\n",
    "で与えられて、$J_{ij}, h_{i}$が$(i,j)$に対して様々な値を持つ模型です。  \n",
    "様々な種類の最適化問題がこのような模型の一番低いエネルギーを求める問題となりますが、エネルギーの最も低い状態を実現する$\\sigma_i$を計算するには一般に非常に難しいです。\n",
    "\n",
    "## 問題の定義 - Graph -\n",
    "\n",
    "問題を定義してみましょう。`graph`の中の**Dense**モジュールが必要となります。\n",
    "> `graph`中には基本的に**Dense**モジュールと**Sparse**モジュールがあり、今回の例のように全ての$J_{ij}$で値が定義されている場合には**Dense**モジュールが適しています。多くの$J_{ij}$の要素が0の場合には**Sparse**が適しています。使い方はどちらもほぼ変わりません。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "import cxxjij.graph as G\n",
    "#問題サイズを100とします。\n",
    "N = 100\n",
    "\n",
    "graph = G.Dense(N)\n",
    "#sparseの場合\n",
    "#graph = G.Sparse(N)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "$J_{ij}, h_i$を設定します。今回は平均0、標準偏差1のGauss分布から生成される値を設定します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Defaulting to user installation because normal site-packages is not writeable\n",
      "Requirement already satisfied: numpy in /home/jiko/.local/lib/python3.8/site-packages (1.18.1)\n"
     ]
    }
   ],
   "source": [
    "!pip install numpy #乱数生成にnumpyを使います。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "mu, sigma = 0, 1\n",
    "\n",
    "for i in range(N):\n",
    "    for j in range(N):\n",
    "        #Jijの値が大きくなりすぎてしまうので、全体の係数を1/Nしています。\n",
    "        graph[i,j] = 0 if i == j else np.random.normal()/N\n",
    "\n",
    "for i in range(N):\n",
    "    graph[i] = np.random.normal()/N"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "ここで、縦磁場に関しては、`graph[i]`でも、`graph[i,i]`でもどちらでもアクセスできます。\n",
    "\n",
    "また、イジングモデルの定義上、$J_{ij}$と$J_{ji}$は自動で同じ値となります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.5\n",
      "0.5\n",
      "-0.6\n",
      "-0.6\n"
     ]
    }
   ],
   "source": [
    "graph[20] = 0.5\n",
    "print(graph[20,20])\n",
    "print(graph[20])\n",
    "graph[12,34] = -0.6\n",
    "print(graph[12,34])\n",
    "print(graph[34,12])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Dense** (および**Sprase**)は以下のメソッドを持っています。\n",
    "\n",
    "- .gen_spin(seed)  \n",
    "    乱数生成のためのseedを与えると、システムサイズ (ここでは$N=100$)分のスピン列を出力します。\n",
    "    seedがない場合にはランダムにseedが決定されます。\n",
    "- .size()  \n",
    "    問題のサイズ($N$)を表示します。\n",
    "- .adj_nodes(i)  \n",
    "    インデックス$i$に隣接するノード一覧を表示します。\n",
    "- .calc_energy(spin)  \n",
    "    スピン列spinを与えられた際に、エネルギー\n",
    "    \\begin{align}  \n",
    "    H &= \\sum_{i<j}J_{ij}\\sigma_i \\sigma_j + \\sum_{i=1}^{N}h_i \\sigma_i\n",
    "    \\end{align}\n",
    "    を計算します。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## システムの設定 - System -\n",
    "\n",
    "続いて計算を行うためのシステムを定義します。ここで古典イジング模型か横磁場イジング模型か、また別の模型にするか等を選べます。\n",
    "\n",
    "まずは古典イジング模型のシステムを作成してみます。`system.make_classical_ising`で作成できます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "import cxxjij.system as S\n",
    "\n",
    "mysystem = S.make_classical_ising(graph.gen_spin(), graph)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "ここで、引数の1つめにはランダムに生成したスピン、2つめはGraphそのものを代入しています。  \n",
    "これにより初期スピン配位が`graph.gen_spin()`となる古典イジング模型のシステムが作成できます。\n",
    "> `system.make_classical_ising`は内部でGraphとspinをそのまま保持しています。実装は[ここ](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/system/classical_ising.hpp#L37)にあり、63行目でメンバ変数\n",
    "```cpp\n",
    "graph::Spins spin;\n",
    "const GraphType interaction;\n",
    "```\n",
    "が定義されています。  \n",
    "古典イジング模型に関しては、行列演算ライブラリEigenを用いて最適化されたシステムである`system.make_classical_ising_Eigen`も用意しています。(実装は[ここ](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/system/classical_ising.hpp#L78))   \n",
    "計算速度はこちらのほうが速いので**実際の用途では`system.make_classical_ising_Eigen`を使うことをおすすめします。**\n",
    "\n",
    "システムに直接アクセスして、値を読むこともできます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-1, 1, -1, 1, 1, 1, -1, -1, 1, -1, 1, 1, 1, 1, 1, 1, -1, 1, 1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, -1, -1, -1, -1, -1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, 1, -1, -1, 1, 1, 1, -1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, -1]\n"
     ]
    }
   ],
   "source": [
    "print(mysystem.spin)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "古典イジング模型以外にも様々なシステムが用意されており、用途別に使うことが出来ます。また、Systemによって初期化の方法は多少異なります。  \n",
    "後ほど少しずつ紹介していきます。\n",
    "\n",
    "## アルゴリズムの実行 -Updater, Algorithm-\n",
    "\n",
    "Systemを定義した後はUpdaterを選択してAlgorithmを実行していきます。  \n",
    "Systemに大して使用できるUpdaterは決められており、古典イジング模型に対するUpdaterは主に\n",
    "\n",
    "- [SingleSpinFlip](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/updater/single_spin_flip.hpp#L40) (メトロポリス・ヘイスティング法によるスピン1つずつのアップデート)\n",
    "- [SwendsenWang](https://github.com/OpenJij/OpenJij/blob/ec41aecfbac7e4c895e1e7a1718f06eb7ffae0ba/src/updater/swendsen_wang.hpp#L45) (SwendsenWang法によるクラスターアップデート)\n",
    "\n",
    "が用意されています。  \n",
    "Algorithmを実行するにはまず**スケジュールリスト**が必要となるため、まずスケジュールリストを作成するところから始めます。\n",
    "\n",
    "### スケジュールリスト\n",
    "\n",
    "スケジュールリストは`(パラメータ, モンテカルロステップ数)`のリストで与えられ、パラメータにいれる値はSystemによって異なります。例えば古典イジング模型ならばパラメータとして温度の逆数である逆温度$\\beta$を設定します。\n",
    "例えばスケジュールリストとして"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "schedule_list = [(0.01, 10),(10, 80),(0.1, 30)]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "と設定された場合、逆温度$\\beta=0.01$で10モンテカルロステップ、$\\beta=10$で80ステップ、$\\beta=0.1$で30ステップの計120モンテカルロステップを実行することを意味します。\n",
    "\n",
    "アニーリングを実行するにあたっては、逆温度は等比級数で増加させていくことが多いため、`utility`にある`make_classical_schedule_list`を使うと便利です。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[((beta: 0.100000) mcs: 20), ((beta: 0.199474) mcs: 20), ((beta: 0.397897) mcs: 20), ((beta: 0.793701) mcs: 20), ((beta: 1.583223) mcs: 20), ((beta: 3.158114) mcs: 20), ((beta: 6.299605) mcs: 20), ((beta: 12.566053) mcs: 20), ((beta: 25.065966) mcs: 20), ((beta: 50.000000) mcs: 20)]\n"
     ]
    }
   ],
   "source": [
    "import cxxjij.utility as U\n",
    "schedule_list = U.make_classical_schedule_list(0.1, 50, 20, 10)\n",
    "print(schedule_list)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "上の例では$\\beta=0.1$から$\\beta=50$まで、各温度で20モンテカルロステップ計算しながら10段階で温度を変えていくため、計200モンテカルロステップの計算となります。\n",
    "\n",
    "### Algorithm\n",
    "\n",
    "続いて、Algorithmを実行していきます。`Algorithm_[Updater]_run`のように書くことで、指定したUpdaterで計算を行うことができます。次例ではSingleSpinFlipを用います。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "import cxxjij.algorithm as A\n",
    "A.Algorithm_SingleSpinFlip_run(mysystem, schedule_list)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "一瞬で処理が終わりましたが、この間に計200モンテカルロステップの計算が終わっています。\n",
    "> `A.Algorithm_SingleSpinFlip_run(mysystem, seed, schedule_list)`とすることで、seedを固定したまま計算を行うことができます。結果に再現性をもたせたい際に使うことができます。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "callbackを使用することでAlgorithmの実行中に1モンテカルロステップごとのシステムを取得することができます。古典イジング模型の場合は、システムとパラメータ (逆温度)を引数を持つ関数を作成すれば良いです。\n",
    "\n",
    "ためしにシステムのエネルギーの値を記録するcallbackを作ってみましょう"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "energies = []\n",
    "\n",
    "def callback_log_energy(system, beta):\n",
    "    #graphは以前にGraphモジュールにて定義したオブジェクトです\n",
    "    energies.append(graph.calc_energy(system.spin))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "このcallbackを用いて同じAlgorithmを実行します。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "#スケジュールをもっと長く取ります (計20000モンテカルロステップ)\n",
    "schedule_list = U.make_classical_schedule_list(0.1, 50, 200, 100)\n",
    "A.Algorithm_SingleSpinFlip_run(mysystem, schedule_list, callback_log_energy)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "記録したシステムのエネルギーを横軸をモンテカルロステップ、縦軸をエネルギーでプロットすると次のようになります。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Defaulting to user installation because normal site-packages is not writeable\n",
      "Requirement already satisfied: matplotlib in /home/jiko/.local/lib/python3.8/site-packages (3.2.0)\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /home/jiko/.local/lib/python3.8/site-packages (from matplotlib) (1.1.0)\n",
      "Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /home/jiko/.local/lib/python3.8/site-packages (from matplotlib) (2.4.6)\n",
      "Requirement already satisfied: python-dateutil>=2.1 in /home/jiko/.local/lib/python3.8/site-packages (from matplotlib) (2.8.1)\n",
      "Requirement already satisfied: numpy>=1.11 in /home/jiko/.local/lib/python3.8/site-packages (from matplotlib) (1.18.1)\n",
      "Requirement already satisfied: cycler>=0.10 in /home/jiko/.local/lib/python3.8/site-packages (from matplotlib) (0.10.0)\n",
      "Requirement already satisfied: setuptools in /home/jiko/.local/lib/python3.8/site-packages (from kiwisolver>=1.0.1->matplotlib) (45.2.0)\n",
      "Requirement already satisfied: six>=1.5 in /home/jiko/.local/lib/python3.8/site-packages (from python-dateutil>=2.1->matplotlib) (1.14.0)\n"
     ]
    }
   ],
   "source": [
    "!pip install matplotlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "plt.plot(range(len(energies)), energies)\n",
    "plt.xlabel('Monte Carlo step')\n",
    "plt.ylabel('energy')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "このように、アニーリングが進むに連れ徐々にエネルギーが低くなっているのが分かります。Algorithmの動作中にシステムの様子を知りたい時に有用です。\n",
    "\n",
    "## 結果の取得 -Result-\n",
    "\n",
    "`result.get_solution`で計算結果であるスピン列を取得できます。古典イジング模型の場合は直接`mysystem.spin`を参照すればスピン列を取得できますが、`result.get_solution`はそれ以外のシステムについてもスピン列を取得できます。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[-1, 1, 1, -1, -1, 1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, 1, 1, -1, -1, -1, 1, 1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, 1, -1, 1, -1, 1, 1, -1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, -1, 1, 1, 1, 1]\n"
     ]
    }
   ],
   "source": [
    "import cxxjij.result as R\n",
    "print(R.get_solution(mysystem))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "このスピン列がアニーリングによって得られた答えなので、ハミルトニアンの基底状態 (に近い状態)であることが期待されます。\n",
    "\n",
    "## `system.make_classical_ising_Eigen` \n",
    "\n",
    "注釈で述べたように、古典イジング模型には線形代数ライブラリである[Eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page)で実装された`system.make_classical_ising_Eigen`があります。`system.make_classical_ising`との計算速度をシステムサイズを変えて比較してみましょう。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYoAAAEKCAYAAAAMzhLIAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8GearUAAAgAElEQVR4nO3dd3jUdfLA8ffQUYoK6Il0QZQiCIFTQL1YUUFUEEE9u1jhRD0PC3piPSzngQjiqfxU9EC8kyI2JCAaRIqgdESliVKUXkPm98dkSQjJsimb75Z5PU8e2O9udie47uTTZkRVcc455/JTKugAnHPOxTZPFM4558LyROGccy4sTxTOOefC8kThnHMuLE8UzjnnwioTdADRUL16da1Xr17QYTjnXNyYPXv2BlWtkdd9CZUoRKQz0Llhw4bMmjUr6HCccy5uiMiK/O5LqKknVR2vqr2qVq0adCjOOZcwEipROOecK34JlShEpLOIDN+8eXPQoTjnXMJIqDUKVR0PjE9JSbk593179+5l9erV7Nq1K4DIXCQqVKhArVq1KFu2bNChOOdySKhEEc7q1aupXLky9erVQ0SCDsfloqps3LiR1atXU79+/aDDcS6+jBwJDz4IK1dCnTrwxBNw1VXF9vRJM/W0a9cuqlWr5kkiRokI1apV8xGfcwU1ciT06gUrVoCq/dmrl10vJgmVKA6168mTRGzz/z7OFcKDD8KOHQde27HDrheThEoUsaxv37688MIL+2+ff/753HTTTftv33PPPTz//POMGzeOp59+GoD333+fhQsX7n/Mn/70p2I7H/Lkk0/me1+9evVo3rw5LVu2pGXLlvTp0weAhx9+mEmTJhXL6zvnisnKlQW7XgieKPIzciTUqwelStmfRRzGtW/fnvT0dAAyMzPZsGEDCxYs2H9/eno67dq14+KLL6Zfv37AwYmiOIVLFABpaWnMnTuXuXPnMmjQIAAGDBjAOeecE5V4nHOFVLNm3tfr1Cm2l0ioRFFs22OjMOfXrl07pk+fDsCCBQto1qwZlStX5vfff2f37t0sWrSIVq1aMWLECO68807S09MZN24cf/3rX2nZsiXLly8H4N1336Vt27accMIJTJs2DbD1l+uvv57mzZtzyimnkJaWBrD/uUI6derElClT6NevHzt37qRly5ZcVYAFr+uuu44xY8YAMHHiRE488URat25Nnz596NSpEwDbt2/nhhtuoG3btpxyyimMHTt2fyyXXXYZHTt2pFGjRtx3332F/rd0zmVZtgx27jz4+mGH2YJ2MUmoXU/htsce4K67YO7c/O//6ivYvfvAazt2wI03wiuv5P09LVtCjqml3GrWrEmZMmVYuXIl6enpnHbaaaxZs4bp06dTtWpVmjdvTrly5fY/PjS66NSpE926ddt/PSMjg6+//pqJEyfy6KOPMmnSJIYMGYKI8N1337F48WLOO+88li5dmm8sTz/9NC+++CJzw/wbpKamUrp0aQCuvfZa+vbtu/++Xbt2ccstt/D5559Tv359evbsuf++J554grPOOovXXnuNTZs20bZt2/2jkLlz5/LNN99Qvnx5GjduTO/evaldu3a+MTjnwvj2WzjvPJv1ePxx+2yK0q6nhEoUxSZ3kjjU9Qi1a9eO9PR00tPTufvuu1mzZg3p6elUrVqV9u3bR/Qcl112GQCtW7fmp59+AuCLL76gd+/eAJx44onUrVs3bKKIRFpaGtWrV8/zvsWLF9OgQYP921h79uzJ8OHDAfjkk08YN24czz77LGBJZWXWXOnZZ59NaKNBkyZNWLFihScK5wrjq6/gggugUiWYMgVOPLFYF69zS85EEeY3f8DWJFbkUR+rbl37j1JIoXWK7777jmbNmlG7dm2ee+45qlSpwvXXXx/Rc5QvXx6A0qVLk5GREfaxZcqUITMzc//tkth6qqq89957NG7c+IDrM2bM2B87RBa/cy4PkybBJZfAscfa3+vWjfpL+hpFXp54wub4ciqGOb927doxYcIEjjrqKEqXLs1RRx3Fpk2bmD59Ou3atTvo8ZUrV2br1q2HfN7TTz+dkVnrJ0uXLmXlypU0btyYevXqMXfuXDIzM1m1ahVff/31/u8pW7Yse/fuLdTP0bhxY3744Yf9I5pRo0btv+/8889n8ODBqCoA33zzTaFewzmXh/ffh4suggYNYNq0EkkSkGCJotiqx151FQwfbv8RROzP4cOLPOfXvHlzNmzYwKmnnnrAtapVq+Y5zdOjRw+eeeYZTjnllP2L2Xm5/fbbyczMpHnz5lxxxRWMGDGC8uXL0759e+rXr0+TJk3o06cPrVq12v89vXr14uSTT853MTs1NXX/9thrrrnmgPsqVqzISy+9RMeO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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "import time\n",
    "\n",
    "N_list = [10, 20, 30, 50, 70, 80, 100, 150, 200, 300, 400, 500, 1000]\n",
    "\n",
    "#計算時間\n",
    "calctime = []\n",
    "#計算時間 (Eigen実装)\n",
    "calctime_eigen = []\n",
    "\n",
    "for N in N_list:\n",
    "    #Graphの初期化\n",
    "    graph = G.Dense(N)\n",
    "    for i in range(N):\n",
    "        for j in range(N):\n",
    "            #Jijの値が大きくなりすぎてしまうので、全体の係数を1/Nしています。\n",
    "            graph[i,j] = 0 if i == j else np.random.normal()/N\n",
    "\n",
    "    for i in range(N):\n",
    "        graph[i] = np.random.normal()/N\n",
    "    \n",
    "    #Systemの初期化\n",
    "    mysystem = S.make_classical_ising(graph.gen_spin(), graph)\n",
    "    mysystem_eigen = S.make_classical_ising_Eigen(graph.gen_spin(), graph)\n",
    "    \n",
    "    #スケジュールリスト (2000モンテカルロステップ)\n",
    "    schedule_list = U.make_classical_schedule_list(0.1, 50, 20, 100)\n",
    "    \n",
    "    t1 = time.time()\n",
    "    #アニーリング (Eigenなし)\n",
    "    A.Algorithm_SingleSpinFlip_run(mysystem, schedule_list)\n",
    "    t2 = time.time()\n",
    "    calctime.append(t2-t1)\n",
    "    \n",
    "    t1 = time.time()\n",
    "    #アニーリング (Eigenあり)\n",
    "    A.Algorithm_SingleSpinFlip_run(mysystem_eigen, schedule_list)\n",
    "    t2 = time.time()\n",
    "    calctime_eigen.append(t2-t1)\n",
    "\n",
    "#結果を両対数プロット\n",
    "plt.plot(N_list, calctime, 'ro-', label='Without Eigen')\n",
    "plt.plot(N_list, calctime_eigen, 'bx-', label='With Eigen')\n",
    "plt.xlabel('System size')\n",
    "plt.ylabel('Elapsed time[s]')\n",
    "plt.xscale('log')\n",
    "plt.yscale('log')\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "全体的にEigen実装のほうが計算が早く、大きいシステムサイズではほぼ10倍ほどのスピード差があります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## C++ core interface\n",
    "\n",
    "C++ core interfaceでも上記とほぼ同じことが可能ですが、多少の違いがあり、\n",
    "\n",
    "- seed値を入れる引数には、乱数生成器 (C++11 random)を代入する必要があります。今までのコードはC++で次のようになります。\n",
    "- Graphクラスで、$J_{ij}, h_i$へのアクセス方法が多少異なります。\n",
    "\n",
    "今までの内容をC++ core interfaceで記述すると次のようになります。"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "```cpp\n",
    "#include <graph/all.hpp>\n",
    "#include <system/all.hpp>\n",
    "#include <updater/all.hpp>\n",
    "#include <algorithm/all.hpp>\n",
    "#include <result/all.hpp>\n",
    "#include <utility/schedule_list.hpp>\n",
    "#include <utility/random.hpp>\n",
    "#include <random>\n",
    "\n",
    "#include <iostream>\n",
    "\n",
    "using namespace openjij;\n",
    "\n",
    "int main(void){\n",
    "\n",
    "    //generate dense graph with size N=100\n",
    "    constexpr std::size_t N = 100;\n",
    "    auto dense = graph::Dense<double>(N);\n",
    "\n",
    "    //generate random engine\n",
    "    auto rand_engine = std::mt19937(0x1234);\n",
    "    //of course you can specify another random generator that is compatible with C++ random generator, say utility::Xorshift,\n",
    "    //auto rand_engine = utility::Xorshift(0x1234);\n",
    "    \n",
    "    //Gaussian distribution\n",
    "    auto gauss = std::normal_distribution<>{0, 1};\n",
    "\n",
    "    //set interactions\n",
    "    for(std::size_t i=0; i<N; i++){\n",
    "        for(std::size_t j=0; j<N; j++){\n",
    "            dense.J(i, j) = (i == j) ? 0 : gauss(rand_engine)/N;\n",
    "        }\n",
    "    }\n",
    "\n",
    "    //set local fields\n",
    "    for(std::size_t i=0; i<N; i++){\n",
    "        dense.h(i) = gauss(rand_engine);\n",
    "    }\n",
    "\n",
    "    //create classical Ising system\n",
    "    auto system = system::make_classical_ising(dense.gen_spin(rand_engine), dense);\n",
    "    //if you use classical Ising system with Eigen implementation, use\n",
    "    //auto system = system::make_classical_ising<system::USE_EIGEN>(dense.gen_spin(rand_engine), dense);\n",
    "\n",
    "    //generate schedule list\n",
    "    //from beta=0.1 to beta=50, 20 Monte Carlo step for each tempearature, 10 samples\n",
    "    auto schedule_list = utility::make_classical_schedule_list(0.1, 50, 20, 10);\n",
    "\n",
    "    //or in the case of classical system, you can specify arbitrary schedules by using a std::vector of utility::Schedule<system::classical_system>\n",
    "    //std::vector<utility::Schedule<system::classical_system>> schedule_list;\n",
    "    //utility::Schedule<system::classical_system> schedule;\n",
    "    //schedule.updater_parameter = {0.01};\n",
    "    //schedule.one_mc_step = 10; //number of Monte Carlo step per temperature\n",
    "    //schedule_list.push_back(schedule);\n",
    "    //\n",
    "    //schedule.updater_parameter = {10};\n",
    "    //schedule.one_mc_step = 80; //number of Monte Carlo step per temperature\n",
    "    //schedule_list.push_back(schedule);\n",
    "    //\n",
    "    //schedule.updater_parameter = {0.1};\n",
    "    //schedule.one_mc_step = 30; //number of Monte Carlo step per temperature\n",
    "    //schedule_list.push_back(schedule); //schedule_list -> [(0.01, 10), (10, 80), (0.1, 30)]\n",
    "\n",
    "\n",
    "    //do annealing (updater: SingleSpinFlip)\n",
    "    algorithm::Algorithm<updater::SingleSpinFlip>::run(system, rand_engine, schedule_list);\n",
    "\n",
    "    //show spins\n",
    "    std::cout << \"The result spins are [\";\n",
    "    for(auto&& elem : result::get_solution(system)){\n",
    "        std::cout << elem << \" \";\n",
    "    }\n",
    "\n",
    "    std::cout << \"]\" << std::endl;\n",
    "}\n",
    "\n",
    "```"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
